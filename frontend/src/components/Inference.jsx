import axios from "axios";
import { useState, useEffect } from "react";
import { useForm } from "react-hook-form";
import Settings from "./Settings";
import ModelInput from "./ModelInput";

const examples = [
  "สร้าง 5 คำถาม: เฟซบุ๊ก (อังกฤษ: Facebook) เป็นบริการเครือข่ายสังคมสัญชาติอเมริกัน สำนักงานใหญ่อยู่ที่ เมนโลพาร์ก รัฐแคลิฟอร์เนีย เฟซบุ๊กก่อตั้งเมื่อวันพุธที่ 4 กุมภาพันธ์ ค.ศ. 2004 โดยมาร์ก ซักเคอร์เบิร์ก และเพื่อนร่วมห้องภายในมหาวิทยาลัย และเหล่าเพื่อนในมหาวิทยาลัยฮาร์วาร์ด พร้อมโดยสมาชิกเพื่อนผู้ก่อตั้ง Eduardo Saverin, Andrew McCollum, Dustin Moskovitz และ Chris Hughes ในท้ายที่สุดเว็บไซต์มีการเข้าชมอย่างจำกัด ทำให้เหล่านักศึกษาภายในมหาวิทยาลัยฮาร์วาร์ด แต่ภายหลังได้ขยายเพิ่มจำนวนในมหาวิทยาลัย ในพื้นที่บอสตัน ไอวีลีก และมหาวิทยาลัยสแตนฟอร์ด และค่อย ๆ รับรองมหาวิทยาลัยอื่นต่าง ๆ และต่อมาก็รับรองโรงเรียนมัธยมศึกษา โดยเฟซบุ๊กให้การอนุญาตให้เยาวชนอายุต่ำกว่า 13 ปีทั่วโลกสามารถสมัครสมาชิกได้ภายในเว็บไซต์ โดยไม่ต้องอ้างอิงหลักฐานใด ๆ ใน ค.ศ. 2020 เฟซบุ๊กอ้างว่ามีผู้ใช้ที่ยังคงใช้งานรายเดือนที่ 2.9 พันล้านคน โดยมีผู้ใช้งานทั่วโลกมากเป็นอันดับ 7 และเป็นแอปโทรศัพท์ที่มีคนโหลดมากที่สุดในคริสต์ทศวรรษ 2010",
  "สร้าง 2 คำถาม: ชาวโยดะยา หรือ ชาวอยุธยาในพม่า เป็นคำที่เรียกกลุ่มชาติพันธุ์ที่มีบรรพบุรุษเป็นชาวสยามจากอาณาจักรอยุธยา ซึ่งอพยพเข้ามาประเทศพม่า มีทั้งอพยพไปพึ่งพระบรมโพธิสมภารกษัตริย์พม่าโดยสมัครใจ บ้างก็เป็นเชลยซึ่งถูกกวาดต้อนเมื่อเกิดสงคราม เมื่อเวลาผ่านไปหลายศตวรรษ ชาวอยุธยาในพม่าค่อย ๆ ผสมปนเปไปกับสังคมพม่า บ้างก็โยกย้ายจากถิ่นฐานเดิม พวกเขาเลิกพูดภาษาไทยและหันไปพูดภาษาพม่า จนกระทั่งทิน มอง จี นักวิชาการชาวพม่าผู้มีเชื้อสายโยดะยาเขียนบทความสั้นชื่อ \"สุสานกษัตริย์ไทย\" (A Thai King’s Tomb) ก่อน พ.ศ. 2538 โดยเชื่อว่าสถูปเก่าองค์หนึ่งในป่าช้าเนินล้านช้างหรือเนินกระแซ (ลินซินกอง) เป็นสุสานของสมเด็จพระเจ้าอุทุมพร อดีตพระมหากษัตริย์อยุธยาผู้นิราศจากบัลลังก์และตกเป็นเชลยในพม่า และเริ่มมีชื่อเสียงจากการที่มัคคุเทศก์พานักท่องเที่ยวไทยไปยังสถูปแห่งหนึ่งในป่าช้าลินซิน แต่กระแสดังกล่าวทำให้เกิดความตื่นตัวในการศึกษาชาวอยุธยาในพม่า และมีความพยายามในการตามหาชุมชนอยุธยาที่ยังหลงเหลืออยู่ในปัจจุบัน",
  "สร้าง 2 คำถาม: สถาบันวิทยสิริเมธี (อังกฤษ: Vidyasirimedhi Institute of Science and Technology: VISTEC) เป็น graduate research intensive university ตั้งอยู่ในพื้นที่วังจันทร์วัลเลย์ (Wangchan Valley) ตำบลป่ายุบใน อำเภอวังจันทร์ จังหวัดระยอง ประเทศไทย ก่อตั้งขึ้นเมื่อปี พ.ศ. 2558 โดยมูลนิธิพลังสร้างสรรค์นวัตกรรม ตามโครงการจัดตั้งสถาบันอุดมศึกษาและโรงเรียนวิทยาศาสตร์ กลุ่ม ปตท. พื้นที่ภาคตะวันออก ด้วยวิสัยทัศน์สำคัญของ ดร.ไพรินทร์ ชูโชติถาวร ประธานมูลนิธิฯ และนายกสภาสถาบันฯ คนแรก ที่มุ่งหวังให้สถาบันฯ ติดอันดับ 1 ใน 50 ของมหาวิทยาลัยวิจัยชั้นนำระดับโลกปัจจุบัน VISTEC มีนายอานันท์ ปันยารชุน ดำรงตำแหน่ง ประธานที่ปรึกษานโยบายสถาบันวิทยสิริเมธี โดยมี ดร.ไพรินทร์ ชูโชติถาวร ดำรงตำแหน่ง นายกสภาสถาบันวิทยสิริเมธี และ ศาสตราจารย์ ดร.จำรัส ลิ้มตระกูล ดำรงตำแหน่ง อธิการบดีสถาบันวิทยสิริเมธี VISTEC มุ่งเน้นการจัดการศึกษาด้านวิทยาศาสตร์ วิศวกรรมศาสตร์ และเทคโนโลยี โดยมีศูนย์วิจัยวิทยาศาสตร์และเทคโนโลยีชั้นแนวหน้า (Frontier Research Center) ซึ่งเป็นศูนย์กลาง ในการเสริมสร้างความเข้มแข็งทางการวิจัยและให้การสนับสนุนด้านทุนการวิจัยแก่สถาบันฯ เป็นศูนย์รวมนักวิจัยที่มีความเชี่ยวชาญสูง ช่วยขับเคลื่อนการดำเนินงานด้านการศึกษา วิจัย การสร้างนวัตกรรม สร้างความร่วมมือทางด้านวิจัยกับสถาบันการศึกษา ภาคธุรกิจ ภาคอุตสาหกรรมและหน่วยงานด้านการวิจัยวิทยาศาสตร์และเทคโนโลยี",
  "สร้าง 2 คำถาม: สำนักงานส่งเสริมเศรษฐกิจดิจิทัล (depa) ร่วมกับ สมาคมการจัดการธุรกิจแห่งประเทศไทย (TMA) นำคณะกรรมการกำกับองค์กรและผู้บริหารระดับสูงที่เข้าร่วมโครงการการพัฒนาทักษะด้าน Digital Transformation สำหรับคณะกรรมการกำกับองค์กร (The Cullinan: The Making of Digital Board) เปิดประสบการณ์ศึกษาระบบนิเวศดิจิทัลจากผู้นำด้านนวัตกรรมดิจิทัลระดับโลก บริษัท แมกโนเลีย ควอลิตี้ ดีเวล็อปเม้นต์ คอร์ปอเรชั่น จำกัด และบริษัท หัวเว่ย เทคโนโลยี่ (ประเทศไทย) จำกัด โดย คณะกรรมการกำกับองค์กรและผู้บริหารระดับสูงกลุ่มแรก ได้รับเกียรติจากคุณทรงพล พลรัฐ President of Digital City Solution Corporation Limited พาเข้าเยี่ยมชมโครงการ THE FORESTIAS โครงการที่อยู่อาศัยแบบ Mixed-use ที่ผสมผสานระหว่างที่อยู่อาศัยและพื้นที่สีเขียว (Natural and Technology Adoption for Resilient Living) โดยคณะกรรมการกำกับองค์กรและผู้บริหารระดับสูงจะได้เรียนรู้ถึงการยกระดับความเป็นอยู่ของคนทุกเจนเนเรชั่นให้มีความสุขและสุขภาพดีอย่างยั่งยืน ผ่านเทคโนโลยีและนวัตกรรมที่ออกแบบมาเพื่อรองรับ Digital Ecosystem ในอนาคต",
  "สร้าง 3 คำถาม: VISAI เป็นบริษัทที่ใช้เทคโนโลยี AI ที่จัดหาเครื่องมือการเรียนรู้ของเครื่องขั้นสูงเพื่อช่วยทุกคนในการสร้างโซลูชัน AI ที่มีประสิทธิภาพสูงและคุณภาพสูงไม่ว่าจะมีหรือไม่มีผู้เชี่ยวชาญก็ตาม เพื่อให้ทันกับโลกที่เปลี่ยนแปลงอย่างรวดเร็วของเทคโนโลยีดิจิทัล ผู้เชี่ยวชาญของเราทำงานอย่างใกล้ชิดกับนักวิจัย AI ชั้นนำในประเทศไทยและประเทศอื่นๆ เพื่อนำเทคโนโลยี AI ที่ล้ำสมัยมาสู่โซลูชันทางธุรกิจ การโต้ตอบอย่างใกล้ชิดกับบริษัทโซลูชันและลูกค้าช่วยให้มั่นใจว่าเครื่องมือการเรียนรู้ของเครื่องที่เรานำเสนอนั้นเหมาะสมกับความต้องการทางธุรกิจอย่างสมบูรณ์แบบ",
  "สร้าง 3 คำถาม: ประวัติศาสตร์หน้าแรกของกลุ่มเซ็นทรัลสามารถย้อนอดีตกลับไปในสมัยของคุณเตียง จิราธิวัฒน์ เจ้าของกิจการร้านค้าเล็กๆ ผู้มีความมุ่งมั่นและเต็มไปด้วยความอุตสาหะมุมานะพยายาม ท่านได้ให้คำมั่นสัญญาที่จะสร้างรากฐานอันมั่นคงแข็งแกร่งให้แก่ครอบครัวในอนาคต ราวต้นปีพุทธศักราช 2493 คุณเตียง จิราธิวัฒน์ เปิดกิจการร้านขายของชำเล็กๆ ร้านแรก โดยขายของใช้เบ็ดเตล็ดและสินค้าจิปาถะในย่านชุมชนเก่าแก่ของกรุงเทพมหานคร ต่อมาในปีพุทธศักราช 2499 คุณเตียง พร้อมด้วยบุตรชายคนโตทั้งสาม คือ สัมฤทธิ์, วันชัย, และ สุทธิพร ได้ขยายกิจการร้านค้าให้เจริญก้าวหน้ามากยิ่งขึ้น ด้วยการก่อตั้งห้างสรรพสินค้าเซ็นทรัลแห่งแรกขึ้นในย่านวังบูรพา ผู้ก่อตั้งกลุ่มเซ็นทรัลทั้งสี่ท่านต่างก็ช่วยกันดำเนินธุรกิจห้างสรรพสินค้าอย่างขยันขันแข็ง โดยต่อมามีสมาชิกครอบครัวอีกหลายคนเข้ามาช่วยกิจการคนละไม้คนละมือด้วยความเป็นน้ำหนึ่งใจเดียวกัน ไม่ว่าจะอยู่ในยุคที่ธุรกิจการค้ารุ่งเรืองเฟื่องฟูมากขึ้นเพียงใดก็ตาม หรือผู้ประกอบการหน้าใหม่จะต่างพากันก่อร่างสร้างธุรกิจของตนเองอย่างรวดเร็วแค่ไหน แต่ห้างสรรพสินค้าเซ็นทรัลยังคงมีเอกลักษณ์พิเศษเฉพาะตัวอย่างหนึ่งที่มิเคยเสื่อมคลายเลย นั่นคือ ความเป็น “ผู้ริเริ่ม” หลากหลายนวัตกรรมให้กับอุตสาหกรรมค้าปลีกของประเทศไทย ไม่ว่าจะเป็นการนำเข้าเครื่องสำอางแบรนด์ดังระดับโลก การให้บริการลูกค้าอย่างสมบูรณ์แบบครบวงจร รวมถึงการนำรูปแบบแนวทางการสื่อสารทางการตลาดมาใช้ในธุรกิจค้าปลีกเป็นแห่งแรกในประเทศไทย คุณสัมฤทธิ์ เชื่อว่า ความสำเร็จจะเกิดขึ้นได้ต้องมาจากความซื่อสัตย์และความขยันหมั่นเพียรในการทำงาน รวมถึงการให้บริการและคัดสรรสินค้าที่ดีที่สุดให้แก่ลูกค้าของเซ็นทรัล",
  "สร้าง 2 คำถาม: Amazon Web Services (AWS) เป็นแพลตฟอร์มคลาวด์ที่ครอบคลุมและนำมาใช้มากที่สุดในโลก โดยนำเสนอบริการอันโดดเด่นเต็มรูปแบบกว่า 200 บริการจากศูนย์ข้อมูลต่างๆ ทั่วโลก ลูกค้ากว่าหลายล้านคน ทั้งสตาร์ทอัพที่เติบโตเร็วที่สุด องค์กรที่ใหญ่ที่สุด และหน่วยงานราชการชั้นนำ ต่างใช้ AWS เพื่อลดค่าใช้จ่าย เพิ่มความคล่องตัว และสร้างสรรค์นวัตกรรมที่รวดเร็วยิ่งขึ้น AWS มีบริการที่หลากหลายกว่าและคุณสมบัติภายในบริการเหล่านั้นก็มีมากกว่าผู้ให้บริการระบบคลาวด์รายอื่นๆ อย่างเห็นได้ชัด ตั้งแต่เทคโนโลยีโครงสร้างพื้นฐานอย่างการคำนวณ การจัดเก็บ และฐานข้อมูล ไปจนถึงเทคโนโลยีเกิดใหม่ เช่น แมชชีนเลิร์นนิ่งและปัญญาประดิษฐ์, Data Lake และการวิเคราะห์ รวมถึงอินเทอร์เน็ตในทุกสิ่ง ซึ่งช่วยให้การย้ายแอปพลิเคชันที่มีอยู่ไปยังคลาวด์สะดวกรวดเร็วขึ้น และคุ้มค่าใช้จ่ายยิ่งขึ้น และสร้างสรรค์งานได้แทบทุกอย่างตามจินตนาการ นอกจากนี้ AWS ยังมีฟังก์ชันการทำงานที่ลึกล้ำที่สุดภายในบริการเหล่านั้น ตัวอย่างเช่น AWS มีฐานข้อมูลมากมายหลายหลากที่ออกแบบมาตามวัตถุประสงค์สำหรับการใช้งานประเภทต่างๆ คุณจึงเลือกเครื่องมือที่เหมาะสมสำหรับงานเพื่อรับความคุ้มค่าและประสิทธิภาพการทำงานสูงสุดได้",
  "สร้าง 2 คำถาม: กรุงศรี (ธนาคารกรุงศรีอยุธยา จำกัด (มหาชน) และบริษัทในเครือ) ประกาศให้บริษัทใหม่ “กรุงศรี นิมเบิล” (Krungsri Nimble) เป็นฮับในการสร้างและดูแลโซลูชั่นด้าน ไอที (IT solutions hub) สนับสนุนการพัฒนาเทคโนโลยีและนวัตกรรมทางการเงินเพิ่มขีดความสามารถในการแข่งขันของกรุงศรีด้วยงบประมาณหลายร้อยล้านบาทต่อปี พร้อมหนุนคนรุ่นใหม่ไฟแรงที่มีศักยภาพด้านวิศวกรรมไอทีที่มีแรงบันดาลใจในการพัฒนาและเปลี่ยนแปลงอย่างสร้างสรรค์ (Making innovative changes) พร้อมเติบโตไปกับองค์กรในบรรยากาศการทำงานที่สนับสนุนการสร้างนวัตกรรมใหม่ๆ",
  "สร้าง 4 คำถาม: เอไอเอ เริ่มดำเนินธุรกิจในประเทศไทย ตั้งแต่ พ.ศ. 2481 ตลอดหลายทศวรรษที่ผ่านมา เอไอเอ มุ่งมั่นที่จะมอบความคุ้มครองที่ครอบคลุมความต้องการของลูกค้าบุคคลและองค์กร ผ่านบริการและผลิตภัณฑ์ที่หลากหลาย อาทิ ผลิตภัณฑ์ประกันชีวิต ประกันอุบัติเหตุ ประกันสุขภาพ ประกันกลุ่ม ประกันสินเชื่อ และให้บริการเป็นผู้จัดการกองทุนสำรองเลี้ยงชีพ ปัจจุบัน กว่า 1 ใน 3 ของกรมธรรม์ประกันชีวิตในประเทศไทยเป็นของเอไอเอ1 บริษัทมีพลังตัวแทนประกันชีวิต 50,000 คน กระจายอยู่ทั่วประเทศและให้บริการลูกค้ากว่า 5.11 ล้านคน ด้วยจำนวนกรมธรรม์กว่า 8.39 ล้านฉบับ นอกจากนี้ เอไอเอ ยังเป็นบริษัทประกันชีวิตชั้นนำที่ริเริ่มใช้แอปพลิเคชันและการบริการต่างๆ เช่น iPoS+  AIA iService และ AIA iSign เพื่อสนับสนุนการขายและให้บริการลูกค้าได้อย่างรวดเร็วและครบวงจร อีกทั้งยังมียอดขายผลิตภัณฑ์ยูนิต ลิงค์1 และจำนวนตัวแทนประกันชีวิตที่ได้รับอนุญาต IC License สูงสุด2 เอไอเอ เป็นบริษัทที่มีความมุ่งมั่นและตั้งใจอย่างแน่วแน่ในการส่งเสริมและสนับสนุนให้คนไทยมี “สุขภาพและชีวิตที่ดีขึ้น” อีกทั้งยังยึดมั่นในการตอบแทนสังคมอย่างแท้จริงผ่านโครงการเพื่อสังคมต่างๆ เช่น โครงการทำดีร่วมกัน (เอไอเอ แชร์ริ่ง อะ ไลฟ์ เดย์) โครงการห้องสมุดเอไอเอ โครงการเอไอเอ สร้างรอยยิ้ม และโครงการเอไอเอ ก้าวใหม่ ชีวิตใหม่ เป็นต้น",
  "สร้าง 3 คำถาม: บริษัท เดลล์ (อังกฤษ: Dell Inc.) เป็นบริษัทผลิตฮาร์ดแวร์คอมพิวเตอร์จากรัฐเท็กซัส สหรัฐอเมริกา ปัจจุบันทำธุรกิจในการพัฒนา ผลิตและประกอบคอมพิวเตอร์ส่วนบุคคล, เซิร์ฟเวอร์, อุปกรณ์สำรองข้อมูล ปัจจุบันมีพนักงานมากกว่า 63,000 คนทำงานอยู่ตามสาขาต่างๆ ทั่วโลกและเป็นผู้ผลิตคอมพิวเตอร์นับเป็นจำนวนเครื่องมากที่สุดในโลก เดลล์ก่อตั้งเมื่อ ค.ศ. 1984 ช่วงแรกใช้ชื่อว่า \"PC's Limited\" โดยไมเคิล เดลล์ ผู้ก่อตั้งซึ่งขณะนั้นยังเป็นนักศึกษาและมีเงินทุนตั้งต้นเพียง 1,000 ดอลลาร์สหรัฐ ไมเคิล เดลล์ทำธุรกิจขายเครื่องโดยใช้วิธีขายตรง ซึ่งส่งผลให้เขารู้ความต้องการที่แท้จริงของลูกค้า",
  "สร้าง 2 คำถาม: ธนาคารกสิกรไทย ก่อตั้งขึ้นเมื่อวันที่ 8 มิถุนายน พ.ศ. 2488 โดยกลุ่มสกุลล่ำซำ ทุนจดทะเบียนเริ่มแรก 5 ล้านบาท โดยมีพนักงานชุดแรก จำนวน 21 คน มีอาคารที่ทำการ ซึ่งปัจจุบันเป็นสาขาสำนักถนนเสือป่า ทั้งนี้ งวดบัญชีแรกของธนาคารฯ นับจนถึงวันที่ 31 ธันวาคม สิ้นปีเดียวกัน มียอดเงินฝากจำนวน 12 ล้านบาท และธนาคารฯ มีสินทรัพย์รวม 15 ล้านบาท ณ วันที่ 30 มิถุนายน พ.ศ. 2557 มีทุนจดทะเบียน 30,486 ล้านบาท มีสินทรัพย์จำนวน 2,339,798 ล้านบาท เงินรับฝากจำนวน 1,567,499 ล้านบาท เงินให้สินเชื่อจำนวน 1,471,922 ล้านบาท มีสาขาและสำนักงานย่อยในเขตกรุงเทพมหานครจำนวน 315 สาขา และส่วนภูมิภาคจำนวน 739 สาขา มีสาขาและสำนักงานตัวแทนต่างประเทศจำนวน 11 แห่ง ได้แก่ สาขาลอสแอนเจลิส สาขาฮ่องกง สาขาหมู่เกาะเคย์แมน สาขาเซินเจิ้น สาขาเฉิงตู สาขาย่อยหลงกั่ง สำนักงานผู้แทนกรุงปักกิ่ง สำนักงานผู้แทนนครเซี่ยงไฮ้ สำนักงานผู้แทนเมืองคุนหมิง สำนักผู้แทนงานกรุงโตเกียว และสำนักงานผู้แทนย่างกุ้ง สาขาและสำนักงานผู้แทนในต่างประเทศเหล่านี้ ให้บริการและส่งเสริมความสะดวกต่าง ๆ ด้านการค้า การเงินระหว่างประเทศไทยและประเทศคู่ค้าทั่วโลก"
]

function Inference() {
  const { register, watch, handleSubmit, setValue } = useForm();
  const [loading, setLoading] = useState(false);
  const [data, setData] = useState("");

  const onSubmit = (data) => {
    setLoading(true);
    axios
      .post("https://ec2-54-169-5-52.ap-southeast-1.compute.amazonaws.com/", {
        input_text: data.input_text,
        model: data.model,
        num_beams: parseInt(data.num_beams),
        max_length: 2048,
        repetition_penalty: parseFloat(data.repetition_penalty),
        early_stopping: true,
        top_p: parseInt(data.top_p),
        top_k: parseInt(data.top_k),
        num_return_sequences: 1,
      })
      .then((response) => {
        setData(response.data);
        setLoading(false);
      });
  };

  useEffect(() => {
    const subscription = watch((value, { name, type }) => {
      if (name === "model" && type === "change") {
        if (value.model === "default" || value.model === "number_separated") {
          setValue("num_beams", 3)
          setValue("repetition_penalty", 2.75)
        } else if (value.model === "augmented_number_separated") {
          setValue("num_beams", 4)
          setValue("repetition_penalty", 3.1)
        }
      }
      if (name === "example" && type === "change") {
        setValue("input_text", examples[parseInt(value.example) - 1])
      }
    });
    return () => subscription.unsubscribe();

  }, [watch])

  return (
    <form
      onSubmit={handleSubmit(onSubmit)}
      className="flex flex-col justify-between row-span-6 md:col-span-2 h-full"
    >
      <ModelInput register={register} loading={loading} data={data} defaultInput/>
      <Settings register={register} />
    </form>
  );
}

export default Inference;
